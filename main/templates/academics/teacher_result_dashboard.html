{% extends 'main/base.html' %}
{% block title %}Teacher Result Dashboard | AHMES{% endblock %}
{% block content %}
<div class="container-fluid">
  <div class="d-sm-flex align-items-center justify-content-between mb-4">
    <h1 class="h3 mb-0 text-gray-800">Weekly Results & Monthly Estimates</h1>
    <a href="{% url 'add_result' %}" class="btn btn-primary">Add Weekly</a>
  </div>

  <div class="card mb-4">
    <div class="card-body table-responsive">
      <h5>Weekly Results</h5>
      <table class="table table-bordered">
        <thead><tr><th>Week</th><th>Student</th><th>Subject</th><th>Exam</th><th>Total</th><th>Grade</th><th>Status</th></tr></thead>
        <tbody>
          {% for r in results %}
            <tr><td>{{ r.week_number }}</td><td>{{ r.student }}</td><td>{{ r.subject }}</td>
              <td>{{ r.exam_score }}</td><td>{{ r.total_score }}</td><td>{{ r.grade }}</td>
              <td>{% if r.is_approved %}Approved{% else %}Pending{% endif %}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card shadow mb-4">
    <div class="card-body">
      <h5>Monthly Averages (Estimation)</h5>
      <table class="table table-bordered">
        <thead><tr><th>Student</th><th>Term/Year</th><th>Month 1 (W1–4)</th><th>Month 2 (W5–8)</th>
          <th>Month 3 (W9–12)</th><th>Month 4 (W13–15)</th></tr></thead>
        <tbody>
          {% for m in monthly %}
          <tr>
            <td>{{ m.student }}</td>
            <td>{{ m.term }}/{{ m.academic_year }}</td>
            <td>{{ m.month1|default:'—'|floatformat:2 }}</td>
            <td>{{ m.month2|default:'—'|floatformat:2 }}</td>
            <td>{{ m.month3|default:'—'|floatformat:2 }}</td>
            <td>{{ m.month4|default:'—'|floatformat:2 }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
